<div class="w-[80vw] max-w-[1440px] mx-auto p-6 space-y-10">


  <!-- Top Bar -->
  <div class="flex items-center justify-between">
    <a routerLink="/newjo"
       class="bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-lg font-semibold transition cursor-pointer">
      Neues Angebot hinzufügen
    </a>

    <a routerLink="/profile"
       class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-lg font-semibold transition cursor-pointer">
      Profile anpassen
    </a>
  </div>

  <!-- Table Section -->
  <section class="bg-gray-800 p-6 rounded-xl shadow-lg space-y-4">
    <h2 class="text-2xl text-white font-semibold">Übersicht aller Jobangebote</h2>

    <!-- Header -->
    <div class="grid grid-cols-5 font-semibold text-gray-300 px-2">
      <span>Name</span>
      <span>Ort</span>
      <span>Gehalt</span>
      <span>Skill-Match</span>
      <span>Aktionen</span>
    </div>
    <div class="border-t border-gray-700"></div>

    <!-- Dynamische Jobangebote -->
    @for (offer of offers; track offer) {
      <div class="mb-1">
        <div
          class="grid grid-cols-5 items-center bg-gray-700 rounded-lg px-2 py-2 hover:bg-gray-600 transition cursor-pointer"
          (click)="toggleDetails(offer)">
          <span class="text-left col-span-1 text-white">{{ offer.company }}</span>
          <span class="text-gray-300 col-span-1 text-sm">{{ offer.location }}</span>
          <span class="text-gray-300 col-span-1 text-sm">{{ offer.salaryRange }}</span>
          <span class="text-green-400 font-semibold text-sm col-span-1">{{ offer.matchScore }}%</span>
          <button
            class="bg-gray-600 text-red-400 hover:text-red-600 font-bold px-3 py-1 text-lg rounded-lg transition col-span-1"
            (click)="deleteOffer(offer); $event.stopPropagation()">
            Löschen
          </button>
        </div>

        <!-- Detail Section -->
        @if (selectedOffer === offer) {
          <div class="bg-gray-900 p-5 rounded-lg space-y-5 border border-gray-700 mt-2">

            <!-- Stellenbeschreibung -->
            <div>
              <h3 class="text-xl text-white font-semibold mb-2">KI Zusammenfassung</h3>
              <p class="text-gray-300">{{ offer.summary }}</p>
            </div>

            <!-- Tech Stack -->
            <div>
              <h3 class="text-xl text-white font-semibold mb-2">Tech Stack</h3>
              <ul class="list-disc list-inside text-gray-300">
                @for (skill of offer.techstack; track skill) {
                  <li>{{ skill }}</li>
                }
              </ul>
            </div>

            <!-- Keyfacts -->
            <div>
              <h3 class="text-xl text-white font-semibold mb-2">Keyfacts</h3>
              <ul class="list-disc list-inside text-gray-300">
                <li><strong>Aufgaben:</strong> {{ offer.tasks }}</li>
                <li><strong>Arbeitsmodell:</strong> {{ offer.workingModel }}</li>
                <li><strong>Erfahrung:</strong> {{ offer.experience }}</li>
                <li><strong>Benefits:</strong> {{ offer.benefits }}</li>
                <li><strong>Kultur:</strong> {{ offer.culture }}</li>
              </ul>
            </div>

            <!-- Match Reasoning -->
            <div>
              <h3 class="text-xl text-white font-semibold mb-2">KI Match</h3>
              <p class="text-gray-300"><strong>Score:</strong> {{ offer.matchScore }}%</p>
              <p class="text-gray-300">Begründung:</p>
              <p class="text-gray-300">{{ offer.matchReasoning }}</p>
            </div>

            <!-- Kommentar -->
            <div>
              <h3 class="text-xl text-white font-semibold mb-2">Kommentar</h3>
              <textarea class="w-full p-3 bg-gray-700 text-white rounded-lg outline-none mb-2"
                        [(ngModel)]="offer.comment"
                        placeholder="Kommentar hinzufügen..."></textarea>
              <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold transition"
                      (click)="updateComment(offer, offer.comment)">
                Speichern
              </button>
            </div>

            <!-- Status Auswahl -->
            <div>
              <h3 class="text-xl text-white font-semibold mb-2">Status</h3>
              <select class="p-3 bg-gray-700 text-white rounded-lg outline-none"
                      [(ngModel)]="offer.status"
                      (change)="updateStatus(offer, offer.status)">
                <option>NEU</option>
                <option>Beworben</option>
                <option>Challenge</option>
                <option>Einladung</option>
                <option>Zusage</option>
                <option>Absage</option>
              </select>
            </div>

          </div>
        }
      </div>
    }

  </section>
</div>
